{"version":3,"file":"index.js","sources":["../dist-src/version.js","../dist-src/add-event-handler.js","../dist-src/oauth-app-octokit.js","../dist-src/emit-event.js","../dist-src/methods/get-user-octokit.js","../dist-src/methods/get-web-flow-authorization-url.js","../dist-src/methods/create-token.js","../dist-src/methods/check-token.js","../dist-src/methods/reset-token.js","../dist-src/methods/refresh-token.js","../dist-src/methods/scope-token.js","../dist-src/methods/delete-token.js","../dist-src/methods/delete-authorization.js","../dist-src/middleware/handle-request.js","../dist-src/middleware/node/parse-request.js","../dist-src/middleware/node/send-response.js","../dist-src/middleware/on-unhandled-request-default.js","../dist-src/middleware/node/index.js","../dist-src/middleware/web-worker/parse-request.js","../dist-src/middleware/web-worker/send-response.js","../dist-src/middleware/web-worker/index.js","../dist-src/middleware/aws-lambda/api-gateway-v2-parse-request.js","../dist-src/middleware/aws-lambda/api-gateway-v2-send-response.js","../dist-src/middleware/aws-lambda/api-gateway-v2.js","../dist-src/index.js"],"sourcesContent":["export const VERSION = \"4.2.0\";\n","export function addEventHandler(state, eventName, eventHandler) {\n    if (Array.isArray(eventName)) {\n        for (const singleEventName of eventName) {\n            addEventHandler(state, singleEventName, eventHandler);\n        }\n        return;\n    }\n    if (!state.eventHandlers[eventName]) {\n        state.eventHandlers[eventName] = [];\n    }\n    state.eventHandlers[eventName].push(eventHandler);\n}\n","import { Octokit } from \"@octokit/core\";\nimport { getUserAgent } from \"universal-user-agent\";\nimport { VERSION } from \"./version\";\nexport const OAuthAppOctokit = Octokit.defaults({\n    userAgent: `octokit-oauth-app.js/${VERSION} ${getUserAgent()}`,\n});\n","export async function emitEvent(state, context) {\n    const { name, action } = context;\n    if (state.eventHandlers[`${name}.${action}`]) {\n        for (const eventHandler of state.eventHandlers[`${name}.${action}`]) {\n            await eventHandler(context);\n        }\n    }\n    if (state.eventHandlers[name]) {\n        for (const eventHandler of state.eventHandlers[name]) {\n            await eventHandler(context);\n        }\n    }\n}\n","import { createOAuthUserAuth, } from \"@octokit/auth-oauth-user\";\nimport { emitEvent } from \"../emit-event\";\nexport async function getUserOctokitWithState(state, options) {\n    return state.octokit.auth({\n        type: \"oauth-user\",\n        ...options,\n        async factory(options) {\n            const octokit = new state.Octokit({\n                authStrategy: createOAuthUserAuth,\n                auth: options,\n            });\n            const authentication = (await octokit.auth({\n                type: \"get\",\n            }));\n            await emitEvent(state, {\n                name: \"token\",\n                action: \"created\",\n                token: authentication.token,\n                scopes: authentication.scopes,\n                authentication,\n                octokit,\n            });\n            return octokit;\n        },\n    });\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nexport function getWebFlowAuthorizationUrlWithState(state, options) {\n    let allowSignup;\n    if (options.allowSignup === undefined && state.allowSignup === undefined) {\n        allowSignup = true;\n    }\n    else if (options.allowSignup === undefined &&\n        state.allowSignup !== undefined) {\n        allowSignup = state.allowSignup;\n    }\n    else if (state.allowSignup === undefined &&\n        options.allowSignup !== undefined) {\n        allowSignup = options.allowSignup;\n    }\n    else {\n        allowSignup = options.allowSignup || state.allowSignup;\n    }\n    const optionsWithDefaults = {\n        clientId: state.clientId,\n        request: state.octokit.request,\n        ...options,\n        allowSignup,\n        redirectUrl: options.redirectUrl || state.redirectUrl,\n        scopes: options.scopes || state.defaultScopes,\n    };\n    return OAuthMethods.getWebFlowAuthorizationUrl({\n        clientType: state.clientType,\n        ...optionsWithDefaults,\n    });\n}\n","import * as OAuthAppAuth from \"@octokit/auth-oauth-app\";\nimport { emitEvent } from \"../emit-event\";\nexport async function createTokenWithState(state, options) {\n    const authentication = await state.octokit.auth({\n        type: \"oauth-user\",\n        ...options,\n    });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"created\",\n        token: authentication.token,\n        scopes: authentication.scopes,\n        authentication,\n        octokit: new state.Octokit({\n            authStrategy: OAuthAppAuth.createOAuthUserAuth,\n            auth: {\n                clientType: state.clientType,\n                clientId: state.clientId,\n                clientSecret: state.clientSecret,\n                token: authentication.token,\n                scopes: authentication.scopes,\n                refreshToken: authentication.refreshToken,\n                expiresAt: authentication.expiresAt,\n                refreshTokenExpiresAt: authentication.refreshTokenExpiresAt,\n            },\n        }),\n    });\n    return { authentication };\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nexport async function checkTokenWithState(state, options) {\n    const result = await OAuthMethods.checkToken({\n        // @ts-expect-error not worth the extra code to appease TS\n        clientType: state.clientType,\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    });\n    Object.assign(result.authentication, { type: \"token\", tokenType: \"oauth\" });\n    return result;\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { emitEvent } from \"../emit-event\";\nimport { createOAuthUserAuth } from \"@octokit/auth-oauth-user\";\nexport async function resetTokenWithState(state, options) {\n    const optionsWithDefaults = {\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    };\n    if (state.clientType === \"oauth-app\") {\n        const response = await OAuthMethods.resetToken({\n            clientType: \"oauth-app\",\n            ...optionsWithDefaults,\n        });\n        const authentication = Object.assign(response.authentication, {\n            type: \"token\",\n            tokenType: \"oauth\",\n        });\n        await emitEvent(state, {\n            name: \"token\",\n            action: \"reset\",\n            token: response.authentication.token,\n            scopes: response.authentication.scopes || undefined,\n            authentication: authentication,\n            octokit: new state.Octokit({\n                authStrategy: createOAuthUserAuth,\n                auth: {\n                    clientType: state.clientType,\n                    clientId: state.clientId,\n                    clientSecret: state.clientSecret,\n                    token: response.authentication.token,\n                    scopes: response.authentication.scopes,\n                },\n            }),\n        });\n        return { ...response, authentication };\n    }\n    const response = await OAuthMethods.resetToken({\n        clientType: \"github-app\",\n        ...optionsWithDefaults,\n    });\n    const authentication = Object.assign(response.authentication, {\n        type: \"token\",\n        tokenType: \"oauth\",\n    });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"reset\",\n        token: response.authentication.token,\n        authentication: authentication,\n        octokit: new state.Octokit({\n            authStrategy: createOAuthUserAuth,\n            auth: {\n                clientType: state.clientType,\n                clientId: state.clientId,\n                clientSecret: state.clientSecret,\n                token: response.authentication.token,\n            },\n        }),\n    });\n    return { ...response, authentication };\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { emitEvent } from \"../emit-event\";\nimport { createOAuthUserAuth } from \"@octokit/auth-oauth-user\";\nexport async function refreshTokenWithState(state, options) {\n    if (state.clientType === \"oauth-app\") {\n        throw new Error(\"[@octokit/oauth-app] app.refreshToken() is not supported for OAuth Apps\");\n    }\n    const response = await OAuthMethods.refreshToken({\n        clientType: \"github-app\",\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        refreshToken: options.refreshToken,\n    });\n    const authentication = Object.assign(response.authentication, {\n        type: \"token\",\n        tokenType: \"oauth\",\n    });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"refreshed\",\n        token: response.authentication.token,\n        authentication: authentication,\n        octokit: new state.Octokit({\n            authStrategy: createOAuthUserAuth,\n            auth: {\n                clientType: state.clientType,\n                clientId: state.clientId,\n                clientSecret: state.clientSecret,\n                token: response.authentication.token,\n            },\n        }),\n    });\n    return { ...response, authentication };\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { createOAuthUserAuth } from \"@octokit/auth-oauth-user\";\nimport { emitEvent } from \"../emit-event\";\nexport async function scopeTokenWithState(state, options) {\n    if (state.clientType === \"oauth-app\") {\n        throw new Error(\"[@octokit/oauth-app] app.scopeToken() is not supported for OAuth Apps\");\n    }\n    const response = await OAuthMethods.scopeToken({\n        clientType: \"github-app\",\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    });\n    const authentication = Object.assign(response.authentication, {\n        type: \"token\",\n        tokenType: \"oauth\",\n    });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"scoped\",\n        token: response.authentication.token,\n        authentication: authentication,\n        octokit: new state.Octokit({\n            authStrategy: createOAuthUserAuth,\n            auth: {\n                clientType: state.clientType,\n                clientId: state.clientId,\n                clientSecret: state.clientSecret,\n                token: response.authentication.token,\n            },\n        }),\n    });\n    return { ...response, authentication };\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { createUnauthenticatedAuth } from \"@octokit/auth-unauthenticated\";\nimport { emitEvent } from \"../emit-event\";\nexport async function deleteTokenWithState(state, options) {\n    const optionsWithDefaults = {\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    };\n    const response = state.clientType === \"oauth-app\"\n        ? await OAuthMethods.deleteToken({\n            clientType: \"oauth-app\",\n            ...optionsWithDefaults,\n        })\n        : // istanbul ignore next\n            await OAuthMethods.deleteToken({\n                clientType: \"github-app\",\n                ...optionsWithDefaults,\n            });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"deleted\",\n        token: options.token,\n        octokit: new state.Octokit({\n            authStrategy: createUnauthenticatedAuth,\n            auth: {\n                reason: `Handling \"token.deleted\" event. The access for the token has been revoked.`,\n            },\n        }),\n    });\n    return response;\n}\n","import * as OAuthMethods from \"@octokit/oauth-methods\";\nimport { createUnauthenticatedAuth } from \"@octokit/auth-unauthenticated\";\nimport { emitEvent } from \"../emit-event\";\nexport async function deleteAuthorizationWithState(state, options) {\n    const optionsWithDefaults = {\n        clientId: state.clientId,\n        clientSecret: state.clientSecret,\n        request: state.octokit.request,\n        ...options,\n    };\n    const response = state.clientType === \"oauth-app\"\n        ? await OAuthMethods.deleteAuthorization({\n            clientType: \"oauth-app\",\n            ...optionsWithDefaults,\n        })\n        : // istanbul ignore next\n            await OAuthMethods.deleteAuthorization({\n                clientType: \"github-app\",\n                ...optionsWithDefaults,\n            });\n    await emitEvent(state, {\n        name: \"token\",\n        action: \"deleted\",\n        token: options.token,\n        octokit: new state.Octokit({\n            authStrategy: createUnauthenticatedAuth,\n            auth: {\n                reason: `Handling \"token.deleted\" event. The access for the token has been revoked.`,\n            },\n        }),\n    });\n    await emitEvent(state, {\n        name: \"authorization\",\n        action: \"deleted\",\n        token: options.token,\n        octokit: new state.Octokit({\n            authStrategy: createUnauthenticatedAuth,\n            auth: {\n                reason: `Handling \"authorization.deleted\" event. The access for the app has been revoked.`,\n            },\n        }),\n    });\n    return response;\n}\n","// @ts-ignore - requires esModuleInterop flag\nimport fromEntries from \"fromentries\";\nexport async function handleRequest(app, { pathPrefix = \"/api/github/oauth\" }, request) {\n    if (request.method === \"OPTIONS\") {\n        return {\n            status: 200,\n            headers: {\n                \"access-control-allow-origin\": \"*\",\n                \"access-control-allow-methods\": \"*\",\n                \"access-control-allow-headers\": \"Content-Type, User-Agent, Authorization\",\n            },\n        };\n    }\n    // request.url may include ?query parameters which we don't want for `route`\n    // hence the workaround using new URL()\n    const { pathname } = new URL(request.url, \"http://localhost\");\n    const route = [request.method, pathname].join(\" \");\n    const routes = {\n        getLogin: `GET ${pathPrefix}/login`,\n        getCallback: `GET ${pathPrefix}/callback`,\n        createToken: `POST ${pathPrefix}/token`,\n        getToken: `GET ${pathPrefix}/token`,\n        patchToken: `PATCH ${pathPrefix}/token`,\n        patchRefreshToken: `PATCH ${pathPrefix}/refresh-token`,\n        scopeToken: `POST ${pathPrefix}/token/scoped`,\n        deleteToken: `DELETE ${pathPrefix}/token`,\n        deleteGrant: `DELETE ${pathPrefix}/grant`,\n    };\n    // handle unknown routes\n    if (!Object.values(routes).includes(route)) {\n        return null;\n    }\n    let json;\n    try {\n        const text = await request.text();\n        json = text ? JSON.parse(text) : {};\n    }\n    catch (error) {\n        return {\n            status: 400,\n            headers: {\n                \"content-type\": \"application/json\",\n                \"access-control-allow-origin\": \"*\",\n            },\n            text: JSON.stringify({\n                error: \"[@octokit/oauth-app] request error\",\n            }),\n        };\n    }\n    const { searchParams } = new URL(request.url, \"http://localhost\");\n    const query = fromEntries(searchParams);\n    const headers = request.headers;\n    try {\n        if (route === routes.getLogin) {\n            const { url } = app.getWebFlowAuthorizationUrl({\n                state: query.state,\n                scopes: query.scopes ? query.scopes.split(\",\") : undefined,\n                allowSignup: query.allowSignup\n                    ? query.allowSignup === \"true\"\n                    : undefined,\n                redirectUrl: query.redirectUrl,\n            });\n            return { status: 302, headers: { location: url } };\n        }\n        if (route === routes.getCallback) {\n            if (query.error) {\n                throw new Error(`[@octokit/oauth-app] ${query.error} ${query.error_description}`);\n            }\n            if (!query.code) {\n                throw new Error('[@octokit/oauth-app] \"code\" parameter is required');\n            }\n            const { authentication: { token }, } = await app.createToken({\n                code: query.code,\n            });\n            return {\n                status: 200,\n                headers: {\n                    \"content-type\": \"text/html\",\n                },\n                text: `<h1>Token created successfully</h1>\n    \n<p>Your token is: <strong>${token}</strong>. Copy it now as it cannot be shown again.</p>`,\n            };\n        }\n        if (route === routes.createToken) {\n            const { code, redirectUrl } = json;\n            if (!code) {\n                throw new Error('[@octokit/oauth-app] \"code\" parameter is required');\n            }\n            const result = await app.createToken({\n                code,\n                redirectUrl,\n            });\n            // @ts-ignore\n            delete result.authentication.clientSecret;\n            return {\n                status: 201,\n                headers: {\n                    \"content-type\": \"application/json\",\n                    \"access-control-allow-origin\": \"*\",\n                },\n                text: JSON.stringify(result),\n            };\n        }\n        if (route === routes.getToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            const result = await app.checkToken({\n                token,\n            });\n            // @ts-ignore\n            delete result.authentication.clientSecret;\n            return {\n                status: 200,\n                headers: {\n                    \"content-type\": \"application/json\",\n                    \"access-control-allow-origin\": \"*\",\n                },\n                text: JSON.stringify(result),\n            };\n        }\n        if (route === routes.patchToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            const result = await app.resetToken({ token });\n            // @ts-ignore\n            delete result.authentication.clientSecret;\n            return {\n                status: 200,\n                headers: {\n                    \"content-type\": \"application/json\",\n                    \"access-control-allow-origin\": \"*\",\n                },\n                text: JSON.stringify(result),\n            };\n        }\n        if (route === routes.patchRefreshToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            const { refreshToken } = json;\n            if (!refreshToken) {\n                throw new Error(\"[@octokit/oauth-app] refreshToken must be sent in request body\");\n            }\n            const result = await app.refreshToken({ refreshToken });\n            // @ts-ignore\n            delete result.authentication.clientSecret;\n            return {\n                status: 200,\n                headers: {\n                    \"content-type\": \"application/json\",\n                    \"access-control-allow-origin\": \"*\",\n                },\n                text: JSON.stringify(result),\n            };\n        }\n        if (route === routes.scopeToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            const result = await app.scopeToken({\n                token,\n                ...json,\n            });\n            // @ts-ignore\n            delete result.authentication.clientSecret;\n            return {\n                status: 200,\n                headers: {\n                    \"content-type\": \"application/json\",\n                    \"access-control-allow-origin\": \"*\",\n                },\n                text: JSON.stringify(result),\n            };\n        }\n        if (route === routes.deleteToken) {\n            const token = headers.authorization?.substr(\"token \".length);\n            if (!token) {\n                throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n            }\n            await app.deleteToken({\n                token,\n            });\n            return {\n                status: 204,\n                headers: { \"access-control-allow-origin\": \"*\" },\n            };\n        }\n        // route === routes.deleteGrant\n        const token = headers.authorization?.substr(\"token \".length);\n        if (!token) {\n            throw new Error('[@octokit/oauth-app] \"Authorization\" header is required');\n        }\n        await app.deleteAuthorization({\n            token,\n        });\n        return {\n            status: 204,\n            headers: { \"access-control-allow-origin\": \"*\" },\n        };\n    }\n    catch (error) {\n        return {\n            status: 400,\n            headers: {\n                \"content-type\": \"application/json\",\n                \"access-control-allow-origin\": \"*\",\n            },\n            text: JSON.stringify({ error: error.message }),\n        };\n    }\n}\n","export function parseRequest(request) {\n    const { method, url, headers } = request;\n    async function text() {\n        const text = await new Promise((resolve, reject) => {\n            let bodyChunks = [];\n            request\n                .on(\"error\", reject)\n                .on(\"data\", (chunk) => bodyChunks.push(chunk))\n                .on(\"end\", () => resolve(Buffer.concat(bodyChunks).toString()));\n        });\n        return text;\n    }\n    return { method, url, headers, text };\n}\n","export function sendResponse(octokitResponse, response) {\n    response.writeHead(octokitResponse.status, octokitResponse.headers);\n    response.end(octokitResponse.text);\n}\n","export function onUnhandledRequestDefault(request) {\n    return {\n        status: 404,\n        headers: { \"content-type\": \"application/json\" },\n        text: JSON.stringify({\n            error: `Unknown route: ${request.method} ${request.url}`,\n        }),\n    };\n}\n","import { parseRequest } from \"./parse-request\";\nimport { sendResponse } from \"./send-response\";\nimport { onUnhandledRequestDefault } from \"../on-unhandled-request-default\";\nimport { handleRequest } from \"../handle-request\";\nfunction onUnhandledRequestDefaultNode(request, response) {\n    const octokitRequest = parseRequest(request);\n    const octokitResponse = onUnhandledRequestDefault(octokitRequest);\n    sendResponse(octokitResponse, response);\n}\nexport function createNodeMiddleware(app, { pathPrefix, onUnhandledRequest, } = {}) {\n    if (onUnhandledRequest) {\n        app.octokit.log.warn(\"[@octokit/oauth-app] `onUnhandledRequest` is deprecated and will be removed from the next major version.\");\n    }\n    onUnhandledRequest ?? (onUnhandledRequest = onUnhandledRequestDefaultNode);\n    return async function (request, response, next) {\n        const octokitRequest = parseRequest(request);\n        const octokitResponse = await handleRequest(app, { pathPrefix }, octokitRequest);\n        if (octokitResponse) {\n            sendResponse(octokitResponse, response);\n        }\n        else if (typeof next === \"function\") {\n            next();\n        }\n        else {\n            onUnhandledRequest(request, response);\n        }\n    };\n}\n","export function parseRequest(request) {\n    // @ts-ignore Worker environment supports fromEntries/entries.\n    const headers = Object.fromEntries(request.headers.entries());\n    return {\n        method: request.method,\n        url: request.url,\n        headers,\n        text: () => request.text(),\n    };\n}\n","export function sendResponse(octokitResponse) {\n    return new Response(octokitResponse.text, {\n        status: octokitResponse.status,\n        headers: octokitResponse.headers,\n    });\n}\n","import { parseRequest } from \"./parse-request\";\nimport { sendResponse } from \"./send-response\";\nimport { handleRequest } from \"../handle-request\";\nimport { onUnhandledRequestDefault } from \"../on-unhandled-request-default\";\nasync function onUnhandledRequestDefaultWebWorker(request) {\n    const octokitRequest = parseRequest(request);\n    const octokitResponse = onUnhandledRequestDefault(octokitRequest);\n    return sendResponse(octokitResponse);\n}\nexport function createWebWorkerHandler(app, { pathPrefix, onUnhandledRequest, } = {}) {\n    if (onUnhandledRequest) {\n        app.octokit.log.warn(\"[@octokit/oauth-app] `onUnhandledRequest` is deprecated and will be removed from the next major version.\");\n    }\n    onUnhandledRequest ?? (onUnhandledRequest = onUnhandledRequestDefaultWebWorker);\n    return async function (request) {\n        const octokitRequest = parseRequest(request);\n        const octokitResponse = await handleRequest(app, { pathPrefix }, octokitRequest);\n        return octokitResponse\n            ? sendResponse(octokitResponse)\n            : await onUnhandledRequest(request);\n    };\n}\n/** @deprecated */\nexport function createCloudflareHandler(...args) {\n    args[0].octokit.log.warn(\"[@octokit/oauth-app] `createCloudflareHandler` is deprecated, use `createWebWorkerHandler` instead\");\n    return createWebWorkerHandler(...args);\n}\n","export function parseRequest(request) {\n    const { method } = request.requestContext.http;\n    let url = request.rawPath;\n    const { stage } = request.requestContext;\n    if (url.startsWith(\"/\" + stage))\n        url = url.substring(stage.length + 1);\n    if (request.rawQueryString)\n        url += \"?\" + request.rawQueryString;\n    const headers = request.headers;\n    const text = async () => request.body || \"\";\n    return { method, url, headers, text };\n}\n","export function sendResponse(octokitResponse) {\n    return {\n        statusCode: octokitResponse.status,\n        headers: octokitResponse.headers,\n        body: octokitResponse.text,\n    };\n}\n","import { parseRequest } from \"./api-gateway-v2-parse-request\";\nimport { sendResponse } from \"./api-gateway-v2-send-response\";\nimport { handleRequest } from \"../handle-request\";\nimport { onUnhandledRequestDefault } from \"../on-unhandled-request-default\";\nasync function onUnhandledRequestDefaultAWSAPIGatewayV2(event) {\n    const request = parseRequest(event);\n    const response = onUnhandledRequestDefault(request);\n    return sendResponse(response);\n}\nexport function createAWSLambdaAPIGatewayV2Handler(app, { pathPrefix, onUnhandledRequest, } = {}) {\n    if (onUnhandledRequest) {\n        app.octokit.log.warn(\"[@octokit/oauth-app] `onUnhandledRequest` is deprecated and will be removed from the next major version.\");\n    }\n    onUnhandledRequest ?? (onUnhandledRequest = onUnhandledRequestDefaultAWSAPIGatewayV2);\n    return async function (event) {\n        const request = parseRequest(event);\n        const response = await handleRequest(app, { pathPrefix }, request);\n        return response ? sendResponse(response) : onUnhandledRequest(event);\n    };\n}\n","import { createOAuthAppAuth } from \"@octokit/auth-oauth-app\";\nimport { VERSION } from \"./version\";\nimport { addEventHandler } from \"./add-event-handler\";\nimport { OAuthAppOctokit } from \"./oauth-app-octokit\";\nimport { getUserOctokitWithState, } from \"./methods/get-user-octokit\";\nimport { getWebFlowAuthorizationUrlWithState, } from \"./methods/get-web-flow-authorization-url\";\nimport { createTokenWithState, } from \"./methods/create-token\";\nimport { checkTokenWithState, } from \"./methods/check-token\";\nimport { resetTokenWithState, } from \"./methods/reset-token\";\nimport { refreshTokenWithState, } from \"./methods/refresh-token\";\nimport { scopeTokenWithState, } from \"./methods/scope-token\";\nimport { deleteTokenWithState, } from \"./methods/delete-token\";\nimport { deleteAuthorizationWithState, } from \"./methods/delete-authorization\";\n// generic handlers\nexport { handleRequest } from \"./middleware/handle-request\";\nexport { createNodeMiddleware } from \"./middleware/node/index\";\nexport { createCloudflareHandler, createWebWorkerHandler, } from \"./middleware/web-worker/index\";\nexport { createAWSLambdaAPIGatewayV2Handler } from \"./middleware/aws-lambda/api-gateway-v2\";\nexport class OAuthApp {\n    static defaults(defaults) {\n        const OAuthAppWithDefaults = class extends this {\n            constructor(...args) {\n                super({\n                    ...defaults,\n                    ...args[0],\n                });\n            }\n        };\n        return OAuthAppWithDefaults;\n    }\n    constructor(options) {\n        const Octokit = options.Octokit || OAuthAppOctokit;\n        this.type = (options.clientType ||\n            \"oauth-app\");\n        const octokit = new Octokit({\n            authStrategy: createOAuthAppAuth,\n            auth: {\n                clientType: this.type,\n                clientId: options.clientId,\n                clientSecret: options.clientSecret,\n            },\n        });\n        const state = {\n            clientType: this.type,\n            clientId: options.clientId,\n            clientSecret: options.clientSecret,\n            // @ts-expect-error defaultScopes not permitted for GitHub Apps\n            defaultScopes: options.defaultScopes || [],\n            allowSignup: options.allowSignup,\n            baseUrl: options.baseUrl,\n            redirectUrl: options.redirectUrl,\n            log: options.log,\n            Octokit,\n            octokit,\n            eventHandlers: {},\n        };\n        this.on = addEventHandler.bind(null, state);\n        // @ts-expect-error TODO: figure this out\n        this.octokit = octokit;\n        this.getUserOctokit = getUserOctokitWithState.bind(null, state);\n        this.getWebFlowAuthorizationUrl = getWebFlowAuthorizationUrlWithState.bind(null, state);\n        this.createToken = createTokenWithState.bind(null, state);\n        this.checkToken = checkTokenWithState.bind(null, state);\n        this.resetToken = resetTokenWithState.bind(null, state);\n        this.refreshToken = refreshTokenWithState.bind(null, state);\n        this.scopeToken = scopeTokenWithState.bind(null, state);\n        this.deleteToken = deleteTokenWithState.bind(null, state);\n        this.deleteAuthorization = deleteAuthorizationWithState.bind(null, state);\n    }\n}\nOAuthApp.VERSION = VERSION;\n"],"names":["VERSION","addEventHandler","state","eventName","eventHandler","Array","isArray","singleEventName","eventHandlers","push","OAuthAppOctokit","Octokit","defaults","userAgent","getUserAgent","emitEvent","context","name","action","getUserOctokitWithState","options","octokit","auth","type","factory","authStrategy","createOAuthUserAuth","authentication","token","scopes","getWebFlowAuthorizationUrlWithState","allowSignup","undefined","optionsWithDefaults","clientId","request","redirectUrl","defaultScopes","OAuthMethods","clientType","createTokenWithState","OAuthAppAuth","clientSecret","refreshToken","expiresAt","refreshTokenExpiresAt","checkTokenWithState","result","Object","assign","tokenType","resetTokenWithState","response","refreshTokenWithState","Error","scopeTokenWithState","deleteTokenWithState","createUnauthenticatedAuth","reason","deleteAuthorizationWithState","handleRequest","app","pathPrefix","method","status","headers","pathname","URL","url","route","join","routes","getLogin","getCallback","createToken","getToken","patchToken","patchRefreshToken","scopeToken","deleteToken","deleteGrant","values","includes","json","text","JSON","parse","error","stringify","searchParams","query","fromEntries","getWebFlowAuthorizationUrl","split","location","error_description","code","authorization","substr","length","checkToken","resetToken","deleteAuthorization","message","parseRequest","Promise","resolve","reject","bodyChunks","on","chunk","Buffer","concat","toString","sendResponse","octokitResponse","writeHead","end","onUnhandledRequestDefault","onUnhandledRequestDefaultNode","octokitRequest","createNodeMiddleware","onUnhandledRequest","log","warn","next","entries","Response","onUnhandledRequestDefaultWebWorker","createWebWorkerHandler","createCloudflareHandler","args","requestContext","http","rawPath","stage","startsWith","substring","rawQueryString","body","statusCode","onUnhandledRequestDefaultAWSAPIGatewayV2","event","createAWSLambdaAPIGatewayV2Handler","OAuthApp","OAuthAppWithDefaults","constructor","createOAuthAppAuth","baseUrl","bind","getUserOctokit"],"mappings":";;;;;;;;;;;;;;AAAO,MAAMA,OAAO,GAAG,mBAAmB;;ACAnC,SAASC,eAAe,CAACC,KAAK,EAAEC,SAAS,EAAEC,YAAY,EAAE;EAC5D,IAAIC,KAAK,CAACC,OAAO,CAACH,SAAS,CAAC,EAAE;IAC1B,KAAK,MAAMI,eAAe,IAAIJ,SAAS,EAAE;MACrCF,eAAe,CAACC,KAAK,EAAEK,eAAe,EAAEH,YAAY,CAAC;;IAEzD;;EAEJ,IAAI,CAACF,KAAK,CAACM,aAAa,CAACL,SAAS,CAAC,EAAE;IACjCD,KAAK,CAACM,aAAa,CAACL,SAAS,CAAC,GAAG,EAAE;;EAEvCD,KAAK,CAACM,aAAa,CAACL,SAAS,CAAC,CAACM,IAAI,CAACL,YAAY,CAAC;AACrD;;ACRO,MAAMM,eAAe,GAAGC,YAAO,CAACC,QAAQ,CAAC;EAC5CC,SAAS,EAAG,wBAAuBb,OAAQ,IAAGc,+BAAY,EAAG;AACjE,CAAC,CAAC;;ACLK,eAAeC,SAAS,CAACb,KAAK,EAAEc,OAAO,EAAE;EAC5C,MAAM;IAAEC,IAAI;IAAEC;GAAQ,GAAGF,OAAO;EAChC,IAAId,KAAK,CAACM,aAAa,CAAE,GAAES,IAAK,IAAGC,MAAO,EAAC,CAAC,EAAE;IAC1C,KAAK,MAAMd,YAAY,IAAIF,KAAK,CAACM,aAAa,CAAE,GAAES,IAAK,IAAGC,MAAO,EAAC,CAAC,EAAE;MACjE,MAAMd,YAAY,CAACY,OAAO,CAAC;;;EAGnC,IAAId,KAAK,CAACM,aAAa,CAACS,IAAI,CAAC,EAAE;IAC3B,KAAK,MAAMb,YAAY,IAAIF,KAAK,CAACM,aAAa,CAACS,IAAI,CAAC,EAAE;MAClD,MAAMb,YAAY,CAACY,OAAO,CAAC;;;AAGvC;;ACVO,eAAeG,uBAAuB,CAACjB,KAAK,EAAEkB,OAAO,EAAE;EAC1D,OAAOlB,KAAK,CAACmB,OAAO,CAACC,IAAI,CAAC;IACtBC,IAAI,EAAE,YAAY;IAClB,GAAGH,OAAO;IACV,MAAMI,OAAO,CAACJ,OAAO,EAAE;MACnB,MAAMC,OAAO,GAAG,IAAInB,KAAK,CAACS,OAAO,CAAC;QAC9Bc,YAAY,EAAEC,iCAAmB;QACjCJ,IAAI,EAAEF;OACT,CAAC;MACF,MAAMO,cAAc,GAAI,MAAMN,OAAO,CAACC,IAAI,CAAC;QACvCC,IAAI,EAAE;OACT,CAAE;MACH,MAAMR,SAAS,CAACb,KAAK,EAAE;QACnBe,IAAI,EAAE,OAAO;QACbC,MAAM,EAAE,SAAS;QACjBU,KAAK,EAAED,cAAc,CAACC,KAAK;QAC3BC,MAAM,EAAEF,cAAc,CAACE,MAAM;QAC7BF,cAAc;QACdN;OACH,CAAC;MACF,OAAOA,OAAO;;GAErB,CAAC;AACN;;ACxBO,SAASS,mCAAmC,CAAC5B,KAAK,EAAEkB,OAAO,EAAE;EAChE,IAAIW,WAAW;EACf,IAAIX,OAAO,CAACW,WAAW,KAAKC,SAAS,IAAI9B,KAAK,CAAC6B,WAAW,KAAKC,SAAS,EAAE;IACtED,WAAW,GAAG,IAAI;GACrB,MACI,IAAIX,OAAO,CAACW,WAAW,KAAKC,SAAS,IACtC9B,KAAK,CAAC6B,WAAW,KAAKC,SAAS,EAAE;IACjCD,WAAW,GAAG7B,KAAK,CAAC6B,WAAW;GAClC,MACI,IAAI7B,KAAK,CAAC6B,WAAW,KAAKC,SAAS,IACpCZ,OAAO,CAACW,WAAW,KAAKC,SAAS,EAAE;IACnCD,WAAW,GAAGX,OAAO,CAACW,WAAW;GACpC,MACI;IACDA,WAAW,GAAGX,OAAO,CAACW,WAAW,IAAI7B,KAAK,CAAC6B,WAAW;;EAE1D,MAAME,mBAAmB,GAAG;IACxBC,QAAQ,EAAEhC,KAAK,CAACgC,QAAQ;IACxBC,OAAO,EAAEjC,KAAK,CAACmB,OAAO,CAACc,OAAO;IAC9B,GAAGf,OAAO;IACVW,WAAW;IACXK,WAAW,EAAEhB,OAAO,CAACgB,WAAW,IAAIlC,KAAK,CAACkC,WAAW;IACrDP,MAAM,EAAET,OAAO,CAACS,MAAM,IAAI3B,KAAK,CAACmC;GACnC;EACD,OAAOC,uCAAuC,CAAC;IAC3CC,UAAU,EAAErC,KAAK,CAACqC,UAAU;IAC5B,GAAGN;GACN,CAAC;AACN;;AC3BO,eAAeO,oBAAoB,CAACtC,KAAK,EAAEkB,OAAO,EAAE;EACvD,MAAMO,cAAc,GAAG,MAAMzB,KAAK,CAACmB,OAAO,CAACC,IAAI,CAAC;IAC5CC,IAAI,EAAE,YAAY;IAClB,GAAGH;GACN,CAAC;EACF,MAAML,SAAS,CAACb,KAAK,EAAE;IACnBe,IAAI,EAAE,OAAO;IACbC,MAAM,EAAE,SAAS;IACjBU,KAAK,EAAED,cAAc,CAACC,KAAK;IAC3BC,MAAM,EAAEF,cAAc,CAACE,MAAM;IAC7BF,cAAc;IACdN,OAAO,EAAE,IAAInB,KAAK,CAACS,OAAO,CAAC;MACvBc,YAAY,EAAEgB,gCAAgC;MAC9CnB,IAAI,EAAE;QACFiB,UAAU,EAAErC,KAAK,CAACqC,UAAU;QAC5BL,QAAQ,EAAEhC,KAAK,CAACgC,QAAQ;QACxBQ,YAAY,EAAExC,KAAK,CAACwC,YAAY;QAChCd,KAAK,EAAED,cAAc,CAACC,KAAK;QAC3BC,MAAM,EAAEF,cAAc,CAACE,MAAM;QAC7Bc,YAAY,EAAEhB,cAAc,CAACgB,YAAY;QACzCC,SAAS,EAAEjB,cAAc,CAACiB,SAAS;QACnCC,qBAAqB,EAAElB,cAAc,CAACkB;;KAE7C;GACJ,CAAC;EACF,OAAO;IAAElB;GAAgB;AAC7B;;AC3BO,eAAemB,mBAAmB,CAAC5C,KAAK,EAAEkB,OAAO,EAAE;EACtD,MAAM2B,MAAM,GAAG,MAAMT,uBAAuB,CAAC;;IAEzCC,UAAU,EAAErC,KAAK,CAACqC,UAAU;IAC5BL,QAAQ,EAAEhC,KAAK,CAACgC,QAAQ;IACxBQ,YAAY,EAAExC,KAAK,CAACwC,YAAY;IAChCP,OAAO,EAAEjC,KAAK,CAACmB,OAAO,CAACc,OAAO;IAC9B,GAAGf;GACN,CAAC;EACF4B,MAAM,CAACC,MAAM,CAACF,MAAM,CAACpB,cAAc,EAAE;IAAEJ,IAAI,EAAE,OAAO;IAAE2B,SAAS,EAAE;GAAS,CAAC;EAC3E,OAAOH,MAAM;AACjB;;ACTO,eAAeI,mBAAmB,CAACjD,KAAK,EAAEkB,OAAO,EAAE;EACtD,MAAMa,mBAAmB,GAAG;IACxBC,QAAQ,EAAEhC,KAAK,CAACgC,QAAQ;IACxBQ,YAAY,EAAExC,KAAK,CAACwC,YAAY;IAChCP,OAAO,EAAEjC,KAAK,CAACmB,OAAO,CAACc,OAAO;IAC9B,GAAGf;GACN;EACD,IAAIlB,KAAK,CAACqC,UAAU,KAAK,WAAW,EAAE;IAClC,MAAMa,QAAQ,GAAG,MAAMd,uBAAuB,CAAC;MAC3CC,UAAU,EAAE,WAAW;MACvB,GAAGN;KACN,CAAC;IACF,MAAMN,cAAc,GAAGqB,MAAM,CAACC,MAAM,CAACG,QAAQ,CAACzB,cAAc,EAAE;MAC1DJ,IAAI,EAAE,OAAO;MACb2B,SAAS,EAAE;KACd,CAAC;IACF,MAAMnC,SAAS,CAACb,KAAK,EAAE;MACnBe,IAAI,EAAE,OAAO;MACbC,MAAM,EAAE,OAAO;MACfU,KAAK,EAAEwB,QAAQ,CAACzB,cAAc,CAACC,KAAK;MACpCC,MAAM,EAAEuB,QAAQ,CAACzB,cAAc,CAACE,MAAM,IAAIG,SAAS;MACnDL,cAAc,EAAEA,cAAc;MAC9BN,OAAO,EAAE,IAAInB,KAAK,CAACS,OAAO,CAAC;QACvBc,YAAY,EAAEC,iCAAmB;QACjCJ,IAAI,EAAE;UACFiB,UAAU,EAAErC,KAAK,CAACqC,UAAU;UAC5BL,QAAQ,EAAEhC,KAAK,CAACgC,QAAQ;UACxBQ,YAAY,EAAExC,KAAK,CAACwC,YAAY;UAChCd,KAAK,EAAEwB,QAAQ,CAACzB,cAAc,CAACC,KAAK;UACpCC,MAAM,EAAEuB,QAAQ,CAACzB,cAAc,CAACE;;OAEvC;KACJ,CAAC;IACF,OAAO;MAAE,GAAGuB,QAAQ;MAAEzB;KAAgB;;EAE1C,MAAMyB,QAAQ,GAAG,MAAMd,uBAAuB,CAAC;IAC3CC,UAAU,EAAE,YAAY;IACxB,GAAGN;GACN,CAAC;EACF,MAAMN,cAAc,GAAGqB,MAAM,CAACC,MAAM,CAACG,QAAQ,CAACzB,cAAc,EAAE;IAC1DJ,IAAI,EAAE,OAAO;IACb2B,SAAS,EAAE;GACd,CAAC;EACF,MAAMnC,SAAS,CAACb,KAAK,EAAE;IACnBe,IAAI,EAAE,OAAO;IACbC,MAAM,EAAE,OAAO;IACfU,KAAK,EAAEwB,QAAQ,CAACzB,cAAc,CAACC,KAAK;IACpCD,cAAc,EAAEA,cAAc;IAC9BN,OAAO,EAAE,IAAInB,KAAK,CAACS,OAAO,CAAC;MACvBc,YAAY,EAAEC,iCAAmB;MACjCJ,IAAI,EAAE;QACFiB,UAAU,EAAErC,KAAK,CAACqC,UAAU;QAC5BL,QAAQ,EAAEhC,KAAK,CAACgC,QAAQ;QACxBQ,YAAY,EAAExC,KAAK,CAACwC,YAAY;QAChCd,KAAK,EAAEwB,QAAQ,CAACzB,cAAc,CAACC;;KAEtC;GACJ,CAAC;EACF,OAAO;IAAE,GAAGwB,QAAQ;IAAEzB;GAAgB;AAC1C;;AC3DO,eAAe0B,qBAAqB,CAACnD,KAAK,EAAEkB,OAAO,EAAE;EACxD,IAAIlB,KAAK,CAACqC,UAAU,KAAK,WAAW,EAAE;IAClC,MAAM,IAAIe,KAAK,CAAC,yEAAyE,CAAC;;EAE9F,MAAMF,QAAQ,GAAG,MAAMd,yBAAyB,CAAC;IAC7CC,UAAU,EAAE,YAAY;IACxBL,QAAQ,EAAEhC,KAAK,CAACgC,QAAQ;IACxBQ,YAAY,EAAExC,KAAK,CAACwC,YAAY;IAChCP,OAAO,EAAEjC,KAAK,CAACmB,OAAO,CAACc,OAAO;IAC9BQ,YAAY,EAAEvB,OAAO,CAACuB;GACzB,CAAC;EACF,MAAMhB,cAAc,GAAGqB,MAAM,CAACC,MAAM,CAACG,QAAQ,CAACzB,cAAc,EAAE;IAC1DJ,IAAI,EAAE,OAAO;IACb2B,SAAS,EAAE;GACd,CAAC;EACF,MAAMnC,SAAS,CAACb,KAAK,EAAE;IACnBe,IAAI,EAAE,OAAO;IACbC,MAAM,EAAE,WAAW;IACnBU,KAAK,EAAEwB,QAAQ,CAACzB,cAAc,CAACC,KAAK;IACpCD,cAAc,EAAEA,cAAc;IAC9BN,OAAO,EAAE,IAAInB,KAAK,CAACS,OAAO,CAAC;MACvBc,YAAY,EAAEC,iCAAmB;MACjCJ,IAAI,EAAE;QACFiB,UAAU,EAAErC,KAAK,CAACqC,UAAU;QAC5BL,QAAQ,EAAEhC,KAAK,CAACgC,QAAQ;QACxBQ,YAAY,EAAExC,KAAK,CAACwC,YAAY;QAChCd,KAAK,EAAEwB,QAAQ,CAACzB,cAAc,CAACC;;KAEtC;GACJ,CAAC;EACF,OAAO;IAAE,GAAGwB,QAAQ;IAAEzB;GAAgB;AAC1C;;AC/BO,eAAe4B,mBAAmB,CAACrD,KAAK,EAAEkB,OAAO,EAAE;EACtD,IAAIlB,KAAK,CAACqC,UAAU,KAAK,WAAW,EAAE;IAClC,MAAM,IAAIe,KAAK,CAAC,uEAAuE,CAAC;;EAE5F,MAAMF,QAAQ,GAAG,MAAMd,uBAAuB,CAAC;IAC3CC,UAAU,EAAE,YAAY;IACxBL,QAAQ,EAAEhC,KAAK,CAACgC,QAAQ;IACxBQ,YAAY,EAAExC,KAAK,CAACwC,YAAY;IAChCP,OAAO,EAAEjC,KAAK,CAACmB,OAAO,CAACc,OAAO;IAC9B,GAAGf;GACN,CAAC;EACF,MAAMO,cAAc,GAAGqB,MAAM,CAACC,MAAM,CAACG,QAAQ,CAACzB,cAAc,EAAE;IAC1DJ,IAAI,EAAE,OAAO;IACb2B,SAAS,EAAE;GACd,CAAC;EACF,MAAMnC,SAAS,CAACb,KAAK,EAAE;IACnBe,IAAI,EAAE,OAAO;IACbC,MAAM,EAAE,QAAQ;IAChBU,KAAK,EAAEwB,QAAQ,CAACzB,cAAc,CAACC,KAAK;IACpCD,cAAc,EAAEA,cAAc;IAC9BN,OAAO,EAAE,IAAInB,KAAK,CAACS,OAAO,CAAC;MACvBc,YAAY,EAAEC,iCAAmB;MACjCJ,IAAI,EAAE;QACFiB,UAAU,EAAErC,KAAK,CAACqC,UAAU;QAC5BL,QAAQ,EAAEhC,KAAK,CAACgC,QAAQ;QACxBQ,YAAY,EAAExC,KAAK,CAACwC,YAAY;QAChCd,KAAK,EAAEwB,QAAQ,CAACzB,cAAc,CAACC;;KAEtC;GACJ,CAAC;EACF,OAAO;IAAE,GAAGwB,QAAQ;IAAEzB;GAAgB;AAC1C;;AC/BO,eAAe6B,oBAAoB,CAACtD,KAAK,EAAEkB,OAAO,EAAE;EACvD,MAAMa,mBAAmB,GAAG;IACxBC,QAAQ,EAAEhC,KAAK,CAACgC,QAAQ;IACxBQ,YAAY,EAAExC,KAAK,CAACwC,YAAY;IAChCP,OAAO,EAAEjC,KAAK,CAACmB,OAAO,CAACc,OAAO;IAC9B,GAAGf;GACN;EACD,MAAMgC,QAAQ,GAAGlD,KAAK,CAACqC,UAAU,KAAK,WAAW,GAC3C,MAAMD,wBAAwB,CAAC;IAC7BC,UAAU,EAAE,WAAW;IACvB,GAAGN;GACN,CAAC;;EAEE,MAAMK,wBAAwB,CAAC;IAC3BC,UAAU,EAAE,YAAY;IACxB,GAAGN;GACN,CAAC;EACV,MAAMlB,SAAS,CAACb,KAAK,EAAE;IACnBe,IAAI,EAAE,OAAO;IACbC,MAAM,EAAE,SAAS;IACjBU,KAAK,EAAER,OAAO,CAACQ,KAAK;IACpBP,OAAO,EAAE,IAAInB,KAAK,CAACS,OAAO,CAAC;MACvBc,YAAY,EAAEgC,6CAAyB;MACvCnC,IAAI,EAAE;QACFoC,MAAM,EAAG;;KAEhB;GACJ,CAAC;EACF,OAAON,QAAQ;AACnB;;AC7BO,eAAeO,4BAA4B,CAACzD,KAAK,EAAEkB,OAAO,EAAE;EAC/D,MAAMa,mBAAmB,GAAG;IACxBC,QAAQ,EAAEhC,KAAK,CAACgC,QAAQ;IACxBQ,YAAY,EAAExC,KAAK,CAACwC,YAAY;IAChCP,OAAO,EAAEjC,KAAK,CAACmB,OAAO,CAACc,OAAO;IAC9B,GAAGf;GACN;EACD,MAAMgC,QAAQ,GAAGlD,KAAK,CAACqC,UAAU,KAAK,WAAW,GAC3C,MAAMD,gCAAgC,CAAC;IACrCC,UAAU,EAAE,WAAW;IACvB,GAAGN;GACN,CAAC;;EAEE,MAAMK,gCAAgC,CAAC;IACnCC,UAAU,EAAE,YAAY;IACxB,GAAGN;GACN,CAAC;EACV,MAAMlB,SAAS,CAACb,KAAK,EAAE;IACnBe,IAAI,EAAE,OAAO;IACbC,MAAM,EAAE,SAAS;IACjBU,KAAK,EAAER,OAAO,CAACQ,KAAK;IACpBP,OAAO,EAAE,IAAInB,KAAK,CAACS,OAAO,CAAC;MACvBc,YAAY,EAAEgC,6CAAyB;MACvCnC,IAAI,EAAE;QACFoC,MAAM,EAAG;;KAEhB;GACJ,CAAC;EACF,MAAM3C,SAAS,CAACb,KAAK,EAAE;IACnBe,IAAI,EAAE,eAAe;IACrBC,MAAM,EAAE,SAAS;IACjBU,KAAK,EAAER,OAAO,CAACQ,KAAK;IACpBP,OAAO,EAAE,IAAInB,KAAK,CAACS,OAAO,CAAC;MACvBc,YAAY,EAAEgC,6CAAyB;MACvCnC,IAAI,EAAE;QACFoC,MAAM,EAAG;;KAEhB;GACJ,CAAC;EACF,OAAON,QAAQ;AACnB;;AC3CA;AACA,AACO,eAAeQ,aAAa,CAACC,GAAG,EAAE;EAAEC,UAAU,GAAG;AAAoB,CAAC,EAAE3B,OAAO,EAAE;EACpF,IAAIA,OAAO,CAAC4B,MAAM,KAAK,SAAS,EAAE;IAC9B,OAAO;MACHC,MAAM,EAAE,GAAG;MACXC,OAAO,EAAE;QACL,6BAA6B,EAAE,GAAG;QAClC,8BAA8B,EAAE,GAAG;QACnC,8BAA8B,EAAE;;KAEvC;;;;EAIL,MAAM;IAAEC;GAAU,GAAG,IAAIC,GAAG,CAAChC,OAAO,CAACiC,GAAG,EAAE,kBAAkB,CAAC;EAC7D,MAAMC,KAAK,GAAG,CAAClC,OAAO,CAAC4B,MAAM,EAAEG,QAAQ,CAAC,CAACI,IAAI,CAAC,GAAG,CAAC;EAClD,MAAMC,MAAM,GAAG;IACXC,QAAQ,EAAG,OAAMV,UAAW,QAAO;IACnCW,WAAW,EAAG,OAAMX,UAAW,WAAU;IACzCY,WAAW,EAAG,QAAOZ,UAAW,QAAO;IACvCa,QAAQ,EAAG,OAAMb,UAAW,QAAO;IACnCc,UAAU,EAAG,SAAQd,UAAW,QAAO;IACvCe,iBAAiB,EAAG,SAAQf,UAAW,gBAAe;IACtDgB,UAAU,EAAG,QAAOhB,UAAW,eAAc;IAC7CiB,WAAW,EAAG,UAASjB,UAAW,QAAO;IACzCkB,WAAW,EAAG,UAASlB,UAAW;GACrC;;EAED,IAAI,CAACd,MAAM,CAACiC,MAAM,CAACV,MAAM,CAAC,CAACW,QAAQ,CAACb,KAAK,CAAC,EAAE;IACxC,OAAO,IAAI;;EAEf,IAAIc,IAAI;EACR,IAAI;IACA,MAAMC,IAAI,GAAG,MAAMjD,OAAO,CAACiD,IAAI,EAAE;IACjCD,IAAI,GAAGC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACF,IAAI,CAAC,GAAG,EAAE;GACtC,CACD,OAAOG,KAAK,EAAE;IACV,OAAO;MACHvB,MAAM,EAAE,GAAG;MACXC,OAAO,EAAE;QACL,cAAc,EAAE,kBAAkB;QAClC,6BAA6B,EAAE;OAClC;MACDmB,IAAI,EAAEC,IAAI,CAACG,SAAS,CAAC;QACjBD,KAAK,EAAE;OACV;KACJ;;EAEL,MAAM;IAAEE;GAAc,GAAG,IAAItB,GAAG,CAAChC,OAAO,CAACiC,GAAG,EAAE,kBAAkB,CAAC;EACjE,MAAMsB,KAAK,GAAGC,WAAW,CAACF,YAAY,CAAC;EACvC,MAAMxB,OAAO,GAAG9B,OAAO,CAAC8B,OAAO;EAC/B,IAAI;IAAA;IACA,IAAII,KAAK,KAAKE,MAAM,CAACC,QAAQ,EAAE;MAC3B,MAAM;QAAEJ;OAAK,GAAGP,GAAG,CAAC+B,0BAA0B,CAAC;QAC3C1F,KAAK,EAAEwF,KAAK,CAACxF,KAAK;QAClB2B,MAAM,EAAE6D,KAAK,CAAC7D,MAAM,GAAG6D,KAAK,CAAC7D,MAAM,CAACgE,KAAK,CAAC,GAAG,CAAC,GAAG7D,SAAS;QAC1DD,WAAW,EAAE2D,KAAK,CAAC3D,WAAW,GACxB2D,KAAK,CAAC3D,WAAW,KAAK,MAAM,GAC5BC,SAAS;QACfI,WAAW,EAAEsD,KAAK,CAACtD;OACtB,CAAC;MACF,OAAO;QAAE4B,MAAM,EAAE,GAAG;QAAEC,OAAO,EAAE;UAAE6B,QAAQ,EAAE1B;;OAAO;;IAEtD,IAAIC,KAAK,KAAKE,MAAM,CAACE,WAAW,EAAE;MAC9B,IAAIiB,KAAK,CAACH,KAAK,EAAE;QACb,MAAM,IAAIjC,KAAK,CAAE,wBAAuBoC,KAAK,CAACH,KAAM,IAAGG,KAAK,CAACK,iBAAkB,EAAC,CAAC;;MAErF,IAAI,CAACL,KAAK,CAACM,IAAI,EAAE;QACb,MAAM,IAAI1C,KAAK,CAAC,mDAAmD,CAAC;;MAExE,MAAM;QAAE3B,cAAc,EAAE;UAAEC;;OAAU,GAAG,MAAMiC,GAAG,CAACa,WAAW,CAAC;QACzDsB,IAAI,EAAEN,KAAK,CAACM;OACf,CAAC;MACF,OAAO;QACHhC,MAAM,EAAE,GAAG;QACXC,OAAO,EAAE;UACL,cAAc,EAAE;SACnB;QACDmB,IAAI,EAAG;AACvB;AACA,4BAA4BxD,KAAM;OACrB;;IAEL,IAAIyC,KAAK,KAAKE,MAAM,CAACG,WAAW,EAAE;MAC9B,MAAM;QAAEsB,IAAI;QAAE5D;OAAa,GAAG+C,IAAI;MAClC,IAAI,CAACa,IAAI,EAAE;QACP,MAAM,IAAI1C,KAAK,CAAC,mDAAmD,CAAC;;MAExE,MAAMP,MAAM,GAAG,MAAMc,GAAG,CAACa,WAAW,CAAC;QACjCsB,IAAI;QACJ5D;OACH,CAAC;;MAEF,OAAOW,MAAM,CAACpB,cAAc,CAACe,YAAY;MACzC,OAAO;QACHsB,MAAM,EAAE,GAAG;QACXC,OAAO,EAAE;UACL,cAAc,EAAE,kBAAkB;UAClC,6BAA6B,EAAE;SAClC;QACDmB,IAAI,EAAEC,IAAI,CAACG,SAAS,CAACzC,MAAM;OAC9B;;IAEL,IAAIsB,KAAK,KAAKE,MAAM,CAACI,QAAQ,EAAE;MAAA;MAC3B,MAAM/C,KAAK,4BAAGqC,OAAO,CAACgC,aAAa,0DAArB,sBAAuBC,MAAM,CAAC,QAAQ,CAACC,MAAM,CAAC;MAC5D,IAAI,CAACvE,KAAK,EAAE;QACR,MAAM,IAAI0B,KAAK,CAAC,yDAAyD,CAAC;;MAE9E,MAAMP,MAAM,GAAG,MAAMc,GAAG,CAACuC,UAAU,CAAC;QAChCxE;OACH,CAAC;;MAEF,OAAOmB,MAAM,CAACpB,cAAc,CAACe,YAAY;MACzC,OAAO;QACHsB,MAAM,EAAE,GAAG;QACXC,OAAO,EAAE;UACL,cAAc,EAAE,kBAAkB;UAClC,6BAA6B,EAAE;SAClC;QACDmB,IAAI,EAAEC,IAAI,CAACG,SAAS,CAACzC,MAAM;OAC9B;;IAEL,IAAIsB,KAAK,KAAKE,MAAM,CAACK,UAAU,EAAE;MAAA;MAC7B,MAAMhD,KAAK,6BAAGqC,OAAO,CAACgC,aAAa,2DAArB,uBAAuBC,MAAM,CAAC,QAAQ,CAACC,MAAM,CAAC;MAC5D,IAAI,CAACvE,KAAK,EAAE;QACR,MAAM,IAAI0B,KAAK,CAAC,yDAAyD,CAAC;;MAE9E,MAAMP,MAAM,GAAG,MAAMc,GAAG,CAACwC,UAAU,CAAC;QAAEzE;OAAO,CAAC;;MAE9C,OAAOmB,MAAM,CAACpB,cAAc,CAACe,YAAY;MACzC,OAAO;QACHsB,MAAM,EAAE,GAAG;QACXC,OAAO,EAAE;UACL,cAAc,EAAE,kBAAkB;UAClC,6BAA6B,EAAE;SAClC;QACDmB,IAAI,EAAEC,IAAI,CAACG,SAAS,CAACzC,MAAM;OAC9B;;IAEL,IAAIsB,KAAK,KAAKE,MAAM,CAACM,iBAAiB,EAAE;MAAA;MACpC,MAAMjD,KAAK,6BAAGqC,OAAO,CAACgC,aAAa,2DAArB,uBAAuBC,MAAM,CAAC,QAAQ,CAACC,MAAM,CAAC;MAC5D,IAAI,CAACvE,KAAK,EAAE;QACR,MAAM,IAAI0B,KAAK,CAAC,yDAAyD,CAAC;;MAE9E,MAAM;QAAEX;OAAc,GAAGwC,IAAI;MAC7B,IAAI,CAACxC,YAAY,EAAE;QACf,MAAM,IAAIW,KAAK,CAAC,gEAAgE,CAAC;;MAErF,MAAMP,MAAM,GAAG,MAAMc,GAAG,CAAClB,YAAY,CAAC;QAAEA;OAAc,CAAC;;MAEvD,OAAOI,MAAM,CAACpB,cAAc,CAACe,YAAY;MACzC,OAAO;QACHsB,MAAM,EAAE,GAAG;QACXC,OAAO,EAAE;UACL,cAAc,EAAE,kBAAkB;UAClC,6BAA6B,EAAE;SAClC;QACDmB,IAAI,EAAEC,IAAI,CAACG,SAAS,CAACzC,MAAM;OAC9B;;IAEL,IAAIsB,KAAK,KAAKE,MAAM,CAACO,UAAU,EAAE;MAAA;MAC7B,MAAMlD,KAAK,6BAAGqC,OAAO,CAACgC,aAAa,2DAArB,uBAAuBC,MAAM,CAAC,QAAQ,CAACC,MAAM,CAAC;MAC5D,IAAI,CAACvE,KAAK,EAAE;QACR,MAAM,IAAI0B,KAAK,CAAC,yDAAyD,CAAC;;MAE9E,MAAMP,MAAM,GAAG,MAAMc,GAAG,CAACiB,UAAU,CAAC;QAChClD,KAAK;QACL,GAAGuD;OACN,CAAC;;MAEF,OAAOpC,MAAM,CAACpB,cAAc,CAACe,YAAY;MACzC,OAAO;QACHsB,MAAM,EAAE,GAAG;QACXC,OAAO,EAAE;UACL,cAAc,EAAE,kBAAkB;UAClC,6BAA6B,EAAE;SAClC;QACDmB,IAAI,EAAEC,IAAI,CAACG,SAAS,CAACzC,MAAM;OAC9B;;IAEL,IAAIsB,KAAK,KAAKE,MAAM,CAACQ,WAAW,EAAE;MAAA;MAC9B,MAAMnD,KAAK,6BAAGqC,OAAO,CAACgC,aAAa,2DAArB,uBAAuBC,MAAM,CAAC,QAAQ,CAACC,MAAM,CAAC;MAC5D,IAAI,CAACvE,KAAK,EAAE;QACR,MAAM,IAAI0B,KAAK,CAAC,yDAAyD,CAAC;;MAE9E,MAAMO,GAAG,CAACkB,WAAW,CAAC;QAClBnD;OACH,CAAC;MACF,OAAO;QACHoC,MAAM,EAAE,GAAG;QACXC,OAAO,EAAE;UAAE,6BAA6B,EAAE;;OAC7C;;;IAGL,MAAMrC,KAAK,6BAAGqC,OAAO,CAACgC,aAAa,2DAArB,uBAAuBC,MAAM,CAAC,QAAQ,CAACC,MAAM,CAAC;IAC5D,IAAI,CAACvE,KAAK,EAAE;MACR,MAAM,IAAI0B,KAAK,CAAC,yDAAyD,CAAC;;IAE9E,MAAMO,GAAG,CAACyC,mBAAmB,CAAC;MAC1B1E;KACH,CAAC;IACF,OAAO;MACHoC,MAAM,EAAE,GAAG;MACXC,OAAO,EAAE;QAAE,6BAA6B,EAAE;;KAC7C;GACJ,CACD,OAAOsB,KAAK,EAAE;IACV,OAAO;MACHvB,MAAM,EAAE,GAAG;MACXC,OAAO,EAAE;QACL,cAAc,EAAE,kBAAkB;QAClC,6BAA6B,EAAE;OAClC;MACDmB,IAAI,EAAEC,IAAI,CAACG,SAAS,CAAC;QAAED,KAAK,EAAEA,KAAK,CAACgB;OAAS;KAChD;;AAET;;ACzNO,SAASC,YAAY,CAACrE,OAAO,EAAE;EAClC,MAAM;IAAE4B,MAAM;IAAEK,GAAG;IAAEH;GAAS,GAAG9B,OAAO;EACxC,eAAeiD,IAAI,GAAG;IAClB,MAAMA,IAAI,GAAG,MAAM,IAAIqB,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MAChD,IAAIC,UAAU,GAAG,EAAE;MACnBzE,OAAO,CACF0E,EAAE,CAAC,OAAO,EAAEF,MAAM,CAAC,CACnBE,EAAE,CAAC,MAAM,EAAGC,KAAK,IAAKF,UAAU,CAACnG,IAAI,CAACqG,KAAK,CAAC,CAAC,CAC7CD,EAAE,CAAC,KAAK,EAAE,MAAMH,OAAO,CAACK,MAAM,CAACC,MAAM,CAACJ,UAAU,CAAC,CAACK,QAAQ,EAAE,CAAC,CAAC;KACtE,CAAC;IACF,OAAO7B,IAAI;;EAEf,OAAO;IAAErB,MAAM;IAAEK,GAAG;IAAEH,OAAO;IAAEmB;GAAM;AACzC;;ACbO,SAAS8B,YAAY,CAACC,eAAe,EAAE/D,QAAQ,EAAE;EACpDA,QAAQ,CAACgE,SAAS,CAACD,eAAe,CAACnD,MAAM,EAAEmD,eAAe,CAAClD,OAAO,CAAC;EACnEb,QAAQ,CAACiE,GAAG,CAACF,eAAe,CAAC/B,IAAI,CAAC;AACtC;;ACHO,SAASkC,yBAAyB,CAACnF,OAAO,EAAE;EAC/C,OAAO;IACH6B,MAAM,EAAE,GAAG;IACXC,OAAO,EAAE;MAAE,cAAc,EAAE;KAAoB;IAC/CmB,IAAI,EAAEC,IAAI,CAACG,SAAS,CAAC;MACjBD,KAAK,EAAG,kBAAiBpD,OAAO,CAAC4B,MAAO,IAAG5B,OAAO,CAACiC,GAAI;KAC1D;GACJ;AACL;;ACJA,SAASmD,6BAA6B,CAACpF,OAAO,EAAEiB,QAAQ,EAAE;EACtD,MAAMoE,cAAc,GAAGhB,YAAY,CAACrE,OAAO,CAAC;EAC5C,MAAMgF,eAAe,GAAGG,yBAAyB,CAACE,cAAc,CAAC;EACjEN,YAAY,CAACC,eAAe,EAAE/D,QAAQ,CAAC;AAC3C;AACA,AAAO,SAASqE,oBAAoB,CAAC5D,GAAG,EAAE;EAAEC,UAAU;EAAE4D;AAAoB,CAAC,GAAG,EAAE,EAAE;EAChF,IAAIA,kBAAkB,EAAE;IACpB7D,GAAG,CAACxC,OAAO,CAACsG,GAAG,CAACC,IAAI,CAAC,0GAA0G,CAAC;;EAEpIF,kBAAkB,KAAKA,kBAAkB,GAAGH,6BAA6B,CAAC;EAC1E,OAAO,gBAAgBpF,OAAO,EAAEiB,QAAQ,EAAEyE,IAAI,EAAE;IAC5C,MAAML,cAAc,GAAGhB,YAAY,CAACrE,OAAO,CAAC;IAC5C,MAAMgF,eAAe,GAAG,MAAMvD,aAAa,CAACC,GAAG,EAAE;MAAEC;KAAY,EAAE0D,cAAc,CAAC;IAChF,IAAIL,eAAe,EAAE;MACjBD,YAAY,CAACC,eAAe,EAAE/D,QAAQ,CAAC;KAC1C,MACI,IAAI,OAAOyE,IAAI,KAAK,UAAU,EAAE;MACjCA,IAAI,EAAE;KACT,MACI;MACDH,kBAAkB,CAACvF,OAAO,EAAEiB,QAAQ,CAAC;;GAE5C;AACL;;AC3BO,SAASoD,cAAY,CAACrE,OAAO,EAAE;;EAElC,MAAM8B,OAAO,GAAGjB,MAAM,CAAC2C,WAAW,CAACxD,OAAO,CAAC8B,OAAO,CAAC6D,OAAO,EAAE,CAAC;EAC7D,OAAO;IACH/D,MAAM,EAAE5B,OAAO,CAAC4B,MAAM;IACtBK,GAAG,EAAEjC,OAAO,CAACiC,GAAG;IAChBH,OAAO;IACPmB,IAAI,EAAE,MAAMjD,OAAO,CAACiD,IAAI;GAC3B;AACL;;ACTO,SAAS8B,cAAY,CAACC,eAAe,EAAE;EAC1C,OAAO,IAAIY,QAAQ,CAACZ,eAAe,CAAC/B,IAAI,EAAE;IACtCpB,MAAM,EAAEmD,eAAe,CAACnD,MAAM;IAC9BC,OAAO,EAAEkD,eAAe,CAAClD;GAC5B,CAAC;AACN;;ACDA,eAAe+D,kCAAkC,CAAC7F,OAAO,EAAE;EACvD,MAAMqF,cAAc,GAAGhB,cAAY,CAACrE,OAAO,CAAC;EAC5C,MAAMgF,eAAe,GAAGG,yBAAyB,CAACE,cAAc,CAAC;EACjE,OAAON,cAAY,CAACC,eAAe,CAAC;AACxC;AACA,AAAO,SAASc,sBAAsB,CAACpE,GAAG,EAAE;EAAEC,UAAU;EAAE4D;AAAoB,CAAC,GAAG,EAAE,EAAE;EAClF,IAAIA,kBAAkB,EAAE;IACpB7D,GAAG,CAACxC,OAAO,CAACsG,GAAG,CAACC,IAAI,CAAC,0GAA0G,CAAC;;EAEpIF,kBAAkB,KAAKA,kBAAkB,GAAGM,kCAAkC,CAAC;EAC/E,OAAO,gBAAgB7F,OAAO,EAAE;IAC5B,MAAMqF,cAAc,GAAGhB,cAAY,CAACrE,OAAO,CAAC;IAC5C,MAAMgF,eAAe,GAAG,MAAMvD,aAAa,CAACC,GAAG,EAAE;MAAEC;KAAY,EAAE0D,cAAc,CAAC;IAChF,OAAOL,eAAe,GAChBD,cAAY,CAACC,eAAe,CAAC,GAC7B,MAAMO,kBAAkB,CAACvF,OAAO,CAAC;GAC1C;AACL;AACA;AACA,AAAO,SAAS+F,uBAAuB,CAAC,GAAGC,IAAI,EAAE;EAC7CA,IAAI,CAAC,CAAC,CAAC,CAAC9G,OAAO,CAACsG,GAAG,CAACC,IAAI,CAAC,oGAAoG,CAAC;EAC9H,OAAOK,sBAAsB,CAAC,GAAGE,IAAI,CAAC;AAC1C;;AC1BO,SAAS3B,cAAY,CAACrE,OAAO,EAAE;EAClC,MAAM;IAAE4B;GAAQ,GAAG5B,OAAO,CAACiG,cAAc,CAACC,IAAI;EAC9C,IAAIjE,GAAG,GAAGjC,OAAO,CAACmG,OAAO;EACzB,MAAM;IAAEC;GAAO,GAAGpG,OAAO,CAACiG,cAAc;EACxC,IAAIhE,GAAG,CAACoE,UAAU,CAAC,GAAG,GAAGD,KAAK,CAAC,EAC3BnE,GAAG,GAAGA,GAAG,CAACqE,SAAS,CAACF,KAAK,CAACpC,MAAM,GAAG,CAAC,CAAC;EACzC,IAAIhE,OAAO,CAACuG,cAAc,EACtBtE,GAAG,IAAI,GAAG,GAAGjC,OAAO,CAACuG,cAAc;EACvC,MAAMzE,OAAO,GAAG9B,OAAO,CAAC8B,OAAO;EAC/B,MAAMmB,IAAI,GAAG,YAAYjD,OAAO,CAACwG,IAAI,IAAI,EAAE;EAC3C,OAAO;IAAE5E,MAAM;IAAEK,GAAG;IAAEH,OAAO;IAAEmB;GAAM;AACzC;;ACXO,SAAS8B,cAAY,CAACC,eAAe,EAAE;EAC1C,OAAO;IACHyB,UAAU,EAAEzB,eAAe,CAACnD,MAAM;IAClCC,OAAO,EAAEkD,eAAe,CAAClD,OAAO;IAChC0E,IAAI,EAAExB,eAAe,CAAC/B;GACzB;AACL;;ACFA,eAAeyD,wCAAwC,CAACC,KAAK,EAAE;EAC3D,MAAM3G,OAAO,GAAGqE,cAAY,CAACsC,KAAK,CAAC;EACnC,MAAM1F,QAAQ,GAAGkE,yBAAyB,CAACnF,OAAO,CAAC;EACnD,OAAO+E,cAAY,CAAC9D,QAAQ,CAAC;AACjC;AACA,AAAO,SAAS2F,kCAAkC,CAAClF,GAAG,EAAE;EAAEC,UAAU;EAAE4D;AAAoB,CAAC,GAAG,EAAE,EAAE;EAC9F,IAAIA,kBAAkB,EAAE;IACpB7D,GAAG,CAACxC,OAAO,CAACsG,GAAG,CAACC,IAAI,CAAC,0GAA0G,CAAC;;EAEpIF,kBAAkB,KAAKA,kBAAkB,GAAGmB,wCAAwC,CAAC;EACrF,OAAO,gBAAgBC,KAAK,EAAE;IAC1B,MAAM3G,OAAO,GAAGqE,cAAY,CAACsC,KAAK,CAAC;IACnC,MAAM1F,QAAQ,GAAG,MAAMQ,aAAa,CAACC,GAAG,EAAE;MAAEC;KAAY,EAAE3B,OAAO,CAAC;IAClE,OAAOiB,QAAQ,GAAG8D,cAAY,CAAC9D,QAAQ,CAAC,GAAGsE,kBAAkB,CAACoB,KAAK,CAAC;GACvE;AACL;;ACDO,MAAME,QAAQ,CAAC;EAClB,OAAOpI,QAAQ,CAACA,QAAQ,EAAE;IACtB,MAAMqI,oBAAoB,GAAG,cAAc,IAAI,CAAC;MAC5CC,WAAW,CAAC,GAAGf,IAAI,EAAE;QACjB,KAAK,CAAC;UACF,GAAGvH,QAAQ;UACX,GAAGuH,IAAI,CAAC,CAAC;SACZ,CAAC;;KAET;IACD,OAAOc,oBAAoB;;EAE/BC,WAAW,CAAC9H,OAAO,EAAE;IACjB,MAAMT,OAAO,GAAGS,OAAO,CAACT,OAAO,IAAID,eAAe;IAClD,IAAI,CAACa,IAAI,GAAIH,OAAO,CAACmB,UAAU,IAC3B,WAAY;IAChB,MAAMlB,OAAO,GAAG,IAAIV,OAAO,CAAC;MACxBc,YAAY,EAAE0H,+BAAkB;MAChC7H,IAAI,EAAE;QACFiB,UAAU,EAAE,IAAI,CAAChB,IAAI;QACrBW,QAAQ,EAAEd,OAAO,CAACc,QAAQ;QAC1BQ,YAAY,EAAEtB,OAAO,CAACsB;;KAE7B,CAAC;IACF,MAAMxC,KAAK,GAAG;MACVqC,UAAU,EAAE,IAAI,CAAChB,IAAI;MACrBW,QAAQ,EAAEd,OAAO,CAACc,QAAQ;MAC1BQ,YAAY,EAAEtB,OAAO,CAACsB,YAAY;;MAElCL,aAAa,EAAEjB,OAAO,CAACiB,aAAa,IAAI,EAAE;MAC1CN,WAAW,EAAEX,OAAO,CAACW,WAAW;MAChCqH,OAAO,EAAEhI,OAAO,CAACgI,OAAO;MACxBhH,WAAW,EAAEhB,OAAO,CAACgB,WAAW;MAChCuF,GAAG,EAAEvG,OAAO,CAACuG,GAAG;MAChBhH,OAAO;MACPU,OAAO;MACPb,aAAa,EAAE;KAClB;IACD,IAAI,CAACqG,EAAE,GAAG5G,eAAe,CAACoJ,IAAI,CAAC,IAAI,EAAEnJ,KAAK,CAAC;;IAE3C,IAAI,CAACmB,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACiI,cAAc,GAAGnI,uBAAuB,CAACkI,IAAI,CAAC,IAAI,EAAEnJ,KAAK,CAAC;IAC/D,IAAI,CAAC0F,0BAA0B,GAAG9D,mCAAmC,CAACuH,IAAI,CAAC,IAAI,EAAEnJ,KAAK,CAAC;IACvF,IAAI,CAACwE,WAAW,GAAGlC,oBAAoB,CAAC6G,IAAI,CAAC,IAAI,EAAEnJ,KAAK,CAAC;IACzD,IAAI,CAACkG,UAAU,GAAGtD,mBAAmB,CAACuG,IAAI,CAAC,IAAI,EAAEnJ,KAAK,CAAC;IACvD,IAAI,CAACmG,UAAU,GAAGlD,mBAAmB,CAACkG,IAAI,CAAC,IAAI,EAAEnJ,KAAK,CAAC;IACvD,IAAI,CAACyC,YAAY,GAAGU,qBAAqB,CAACgG,IAAI,CAAC,IAAI,EAAEnJ,KAAK,CAAC;IAC3D,IAAI,CAAC4E,UAAU,GAAGvB,mBAAmB,CAAC8F,IAAI,CAAC,IAAI,EAAEnJ,KAAK,CAAC;IACvD,IAAI,CAAC6E,WAAW,GAAGvB,oBAAoB,CAAC6F,IAAI,CAAC,IAAI,EAAEnJ,KAAK,CAAC;IACzD,IAAI,CAACoG,mBAAmB,GAAG3C,4BAA4B,CAAC0F,IAAI,CAAC,IAAI,EAAEnJ,KAAK,CAAC;;AAEjF;AACA8I,QAAQ,CAAChJ,OAAO,GAAGA,OAAO;;;;;;;;;"}